# MLOps labs environment.

The labs in this repo are designed to run in a simplified MLOps environment. 

![Reference topolgy](/images/lab-env.png)

The core services in the environment are:
- **AI Platform Notebooks** - your development experimentation environment
- **Cloud Storage** - a GCS bucket for pipeline artifacts
- **Kubeflow Pipelines** - a lightweight deployment of Kubeflow Pipelines on GKE hosting ML Pipelines and ML Metadata services. GKE will also be used as a primary execution environment for KFP and TFX components.
- **Cloud Build** - CI/CD
- **Container Registry** - a registry for container images encapsulating pipeline components


In the lab environment, all services are provisioned in the same [Google Cloud Project](https://cloud.google.com/storage/docs/projects). 


## Provisioning a lab environment
Before proceeding make sure that your account has access to the project and is assigned to the **Owner** or **Editor** role.

Although you can run the below commands from any workstation configured with *Google Cloud SDK*, the following instructions have been tested on GCP [Cloud Shell](https://cloud.google.com/shell/).



To provision KFP environment

1. Open **Cloud Shell**
2. Clone this repo under the `home` folder.
```
cd /
git clone https://github.com/jarokaz/mlops-miniworkshop.git
cd mlops-miniworkshop/lab-01-environment-setup
```

3. Start installation
```
./install.sh $PROJECT_ID $PREFIX
```

The script installs GKE to the `us-central1-a` zone, which is a recommended location. If you need to install GKE to some other zone, specify the zone name as the last argument.

4. Review the logs generated by the script for any errors.

## Accessing KFP UI

After the installation completes, you can access the KFP UI from the following URL. You may need to wait a few minutes before the URL is operational.

```
gcloud container clusters get-credentials $PREFIX-cluster --zone $ZONE
echo "https://"$(kubectl describe configmap inverse-proxy-config -n \
$NAMESPACE | grep "googleusercontent.com")
```
